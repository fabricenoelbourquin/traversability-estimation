# Motor constants (R, k_t, G) are loaded from config/metrics.private.yaml (gitignored).
metrics:
  names:
    - speed_error_abs
    - power_mech
    - power_joule_heating
    - power
    - cost_of_transport
    - cost_of_transport_mech
#    - joint_travel_rate_L1
#    - joint_travel_cum_L1
#    - torque_L1_rate
#    - power_mech_signed
#    - energy_pos_cum
#    - cot_running
  cumulative:
#    - joint_travel_cum_L1
#    - energy_pos_cum
#    - cot_running
  separate_output: true 
params:
  max_speed_mps: 1
  min_speed_for_power_norm: 0.1     # > 1e-4
  min_cmd_speed_for_power_norm: 0.2
  min_cmd_speed_pad_s: 1          # mark samples within this time of sub-threshold cmd speed as invalid

# Parameters for the local-plane-fitting DEM slope calculation
dem_slope_params:
  # Size of the square patch to fit the plane (e.g., 5 -> 5x5 pixels).
  # MUST be an odd number.
  patch_size_pixels: 7

  # Method for weighting pixels in the least-squares fit.
  # "uniform": All pixels in the patch are weighted equally.
  # "gaussian": Pixels closer to the center are weighted more.
  weighting_method: "gaussian"

  # Standard deviation (in pixels) for the Gaussian weight kernel.
  # Only used if weighting_method is "gaussian".
  # A good starting value is (patch_size_pixels / 4).
  weighting_sigma_pixels: 2.25

filters:
  # leave default as pass-through so only explicitly listed signals are smoothed
  default:
    type: none

  speed_error_abs:
    - type: moving_median  # suppress single-frame spikes
      window: 5
    - type: moving_average # smooth residual jitter
      window: 35

  speed_tracking_score:
    type: moving_average
    window: 25

  joint_travel_rate_L1:
    - type: moving_median
      window: 5
    - type: moving_average
      window: 35

  torque_L1_rate:
    - type: moving_median
      window: 7
    - type: moving_average
      window: 45
  
  power_mech:
    - type: moving_median
      window: 5
    - type: moving_average
      window: 25
  
  power_mech_signed:
    - type: moving_median
      window: 5
    - type: moving_average
      window: 25

  power_joule_heating:
    - type: moving_median
      window: 5
    - type: moving_average
      window: 25

  power:
    - type: moving_median
      window: 5
    - type: moving_average
      window: 25

  cost_of_transport_speed:
    - type: hampel
      window: 51
      k: 3.0
    - type: moving_median
      window: 5
    - type: moving_average
      window: 15

  cost_of_transport_power:
    - type: moving_median
      window: 1
    - type: moving_average
      window: 1

  cost_of_transport:
    - type: hampel
      window: 51
      k: 3.0
    - type: moving_median
      window: 5
    - type: moving_average
      window: 15

robot:
  mass_kg: 30.0      
  gravity: 9.81
